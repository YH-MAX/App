WaterAPP Backend â€“ API Documentation

Backend: Spring Boot (Java)
Auth: JWT
Base Path: /api/*

This document contains the complete API reference for Waterapp, including:

User Authentication

Water Sensor Data

Pollution Reports

Community Forum

Auto Alert System

Global Status Codes & Headers

Table of Contents

User API (/api/users)

Sensor API (/api/sensor)

Pollution Report API (/api/reports)

Community API (/api/community)

Alert API (/api/alerts)

Global Headers

Global Status Codes

Base URL

<a id="user-api"></a> 1. User API â€” /api/users
1.1 Register
POST /api/users/register

Create a new user.

Request Body
{
  "name": "Yan Han",
  "email": "yan@example.com",
  "password": "123456",
  "role": "USER"
}
Response
{
  "id": 1,
  "name": "Yan Han",
  "email": "yan@example.com",
  "role": "USER",
  "createdAt": "2025-01-02T10:00:00"
}
1.2 Login
POST /api/users/login

Authenticate user and return JWT.

Request Body
{
  "email": "yan@example.com",
  "password": "123456"
}
Response
{
  "token": "JWT_TOKEN_HERE",
  "email": "yan@example.com",
  "message": "Login successful!"
}
<a id="sensor-api"></a> 2. Sensor API â€” /api/sensor
2.1 Upload Sensor Data
POST /api/sensor/upload

Upload pH / temperature / turbidity for the current user.

Requires JWT

Request Body
{
  "ph": 6.9,
  "temperature": 27.8,
  "turbidity": 4.1,
  "location": "KK3"
}
Response
{
  "id": 15,
  "email": "user@example.com",
  "ph": 6.9,
  "temperature": 27.8,
  "turbidity": 4.1,
  "location": "KK3",
  "timestamp": "2025-01-02T10:12:30"
}
2.2 Get Latest Sensor Data
GET /api/sensor/me/latest
Response
{
  "ph": 7.1,
  "temperature": 26.4,
  "turbidity": 3.2,
  "location": "KK5",
  "timestamp": "2025-01-02T11:00:00",
  "status": "GOOD"
}
2.3 Get Data by Date Range
GET /api/sensor/me/range?from=...&to=...
Response
[
  {
    "ph": 7.0,
    "temperature": 26.0,
    "turbidity": 3.9,
    "location": "KK12",
    "timestamp": "2025-01-01T11:00:00",
    "status": "FAIR"
  }
]
2.4 Summary
GET /api/sensor/me/summary?from=...&to=...
Response
{
  "avgPh": 7.05,
  "avgTemperature": 26.7,
  "avgTurbidity": 3.8,
  "overallStatus": "FAIR",
  "count": 12
}
<a id="pollution-report-api"></a> 3. Pollution Report API â€” /api/reports
3.1 Submit Report
POST /api/reports

ðŸ”’ Requires JWT

Request Body
{
  "description": "Water smells strange near KK11.",
  "photoUrl": "https://example.com/pic.jpg",
  "location": "KK11"
}
Response
{
  "message": "Report submitted successfully.",
  "id": 12,
  "description": "Water smells strange near KK11.",
  "photoUrl": "https://example.com/pic.jpg",
  "location": "KK11",
  "status": "PENDING",
  "createdAt": "2025-01-01T10:00:00",
  "autoGenerated": false,
  "adminComment": null,
  "resolvedAt": null
}
3.2 My Reports
GET /api/reports/me

Returns only the current userâ€™s reports.

3.3 All Reports
GET /api/reports
3.4 Update Status (Admin)
PUT /api/reports/{id}/status
Request Body
{
  "status": "RESOLVED",
  "adminComment": "Issue fixed."
}
<a id="community-api"></a> 4. Community API â€” /api/community
4.1 Create Post
POST /api/community/posts

Requires JWT

Request Body
{
  "content": "Water looks cloudy.",
  "photoUrl": "https://example.com/img.jpg",
  "location": "UM Lake",
  "ph": 6.8,
  "temperature": 28.4,
  "turbidity": 3.5,
  "type": "report"
}
4.2 Get All Posts
GET /api/community/posts

Optional: ?location=KK5

4.3 Get Post By ID
GET /api/community/posts/{id}
4.4 Like Post
POST /api/community/posts/{postId}/like
4.5 Reply to Post
POST /api/community/posts/{postId}/replies

Requires JWT

Request Body
{
  "content": "Agree, turbidity is high.",
  "expertReply": false
}
4.6 Get Replies
GET /api/community/posts/{postId}/replies
<a id="alert-api"></a> 5. Alert API â€” /api/alerts
5.1 Evaluate Water Reading
POST /api/alerts/evaluate
Request Body
{
  "ph": 7.2,
  "temperature": 25.5,
  "turbidity": 3.8
}
Response
{
  "alert": true,
  "severity": "HIGH",
  "message": "Dangerous contamination detected!"
}
<a id="global-headers"></a> 6. Global Headers
For JWT-protected endpoints:
Authorization: Bearer <token>
Content-Type: application/json

<a id="global-status-codes"></a> 7. Global Status Codes
Code	Meaning
200	OK
201	Created
400	Bad Request
401	Unauthorized
403	Forbidden
404	Not Found
500	Server Error
<a id="base-url"></a> 8. Base URL
Local Development
http://localhost:8080

Production Example
https://smartwater.yourdomain.com
